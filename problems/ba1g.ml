open! Core

(* http://rosalind.info/problems/ba1g/ *)

let hamming_dist text1 text2 =
  let rec loop i ham_dist =
    if String.length text1 < i + 1
    then ham_dist
    else if Char.(text1.[i] = text2.[i])
    then loop (i + 1) ham_dist
    else loop (i + 1) (ham_dist + 1)
  in
  loop 0 0
;;

let%expect_test "" =
  print_s
    [%sexp
      (hamming_dist
         "CTCGCGACCCGCCCATCGATCAAAGCGTGTTCGGCTGGTCTTACCGAGGGGAATCCTCGTCTCGACAATCTTAGAAATTCCTTCCACCAATGCCCGTCTATGTTTCAGCCAGGGTCTTCGGTGGCCTCTCATCCGTTAACAGATGCAGGTTACTATACGTTCTCCGGATAGGACATACGCGCAGTCGGTCTAACCATGACGGTACGGATACGGTTCCGTACGACTCTGTACGATTCACCGTGTAGAGTTACTCTATCGGCAAGATGTCCGATTAAATCGGCTGGCGCTGTCCACACCACGCTTTTAAGGTAACGACTAACCGTAAACTTTCGCGAGCAGTTACTGGAGCCTAACGGCCGGCGACACACGGGATCCTACAGATATCATCTTACAATGATTGATGCGTTTTATGAGCGAAGGTGATCGGATCGCGGAACCGTTTATGTGCTTTCGAACCACTCCCTGGGACTAAGTTATACTGTTGTCGCCACACAAGCAACACGGTGTGTGTAAGACCCGTTGTTAGTGTGAGAGCGGGATTGCCAGCCTCGAGCACCTCCATAACCCACGGCGAATGTACTAACTGGTAGCTACATTACCTTGACGGGAAGGAAATATAAGAGAAATATCTAGATTTACGGTCTTGTAATTGGGGCTAGTACTGACGAGTTTGCCTCCTAATTGGCGCAAATGGGTTGAAGCTATGGATAGGACAACAGCTAGCGATCAGTGGCCAACACAAACGGCTCCAAAGTGTGCAAGAATAAACACGATCGATGCGACGGGCGAGAACATTACTGACCCCCCGTACTATGGTGCAAGAAATCGATGAGTCAATTTGCGAGTGCGGTTGTGTACAAGTCTTATATGGAAATGCCAGCCGCAGGCACAACTGTGTTCATGGACAAAGACAAGCTACGGGATCTACTACAAGGGGGGAGCTCGTTTTGAAAAGGGTCATTCAGTCAAGCAACTGTGCCTTCCGGAGCGATGGAAGCATGCCTTATGTCACACGGAGTTCTGTGCTTCTAAGGACTGCGTCTAGGGCCACAAACGCGCGGCGGAAC"
         "CAGTCGACGATCGTGCATAACCCGTAGCGTTGAAGAGGTAATATGCCCATCTAGAGTTAGGCCTCGTCCCGATTGTGCAACGTATCTTGACATTATAGGCTTCTTATACTCTTCGCAATGCAACGTCGGTTGTAACTTCCCAGTCCCAGTTTCATGACGAGAGGAGTCGTTAAACAGGTAATCAGGACTGTGCACAAATGACGGCACTCATCATCCCCTGCAGGCTGATAAGCGAGTTTCCAACGGAGGCTTTTTATGGATATTATCACCGTTCACTGTGATGGGTGGCGTAGATGAAACAGACTCGAAGAGCTCCCGCTGTGTACCTAGCCAGTTGTATGTACTCCGATCTGAGGTTGCGCGTCACTTACATCGAGCATTGTCGCTTAATGAAATTAAGCGAGATCGATGATAGCCCTCACTTACGATCCTGAGGCGAAGTAGCAAACTTTGATATATGTCGGACTCACATGGATGGAAGGGCCACAAATACGTGCAATTATGTATAAGGGATAACCTACAGAAAAAAGACGCTCCCACCTCATGCCAATGCGCTTGAGGACTTCTTAGGAAGTCGTGGGAGGCATGGCGTTCTTATCGTAACAATGGTTAGAGACTCTACAGTAGAGGCTCAAAGAATAAAGTGTGGGGAGGTATATACTTCTGAGCCAGTCGTTTCTACGTGAGGATTACGTCTGGCATGTGAGGTCATCAACCGGGTACCGTGACTAAGCCCATGACAGTGCGTCTCGGCGATCGGTTCTTCACCAGGCATGTATGTCCAGTACCGGCCTACGTTAATTGCTGAAGCAATTGCTTGGATTTTGCGCATGATATTGCGTAGGCACGGTAAGGTTTCATAATGAATGTTACGGTCCCCAGTAATTCCCCAAGGCAATCCCCATTGATGTAGTCGCGAGCGCGAGTAAATTACAACCGCAAGTCATGTTTAATATGGTACGAAATGACTCATTGTCGAAGTACATCCTGAAGAGCTGGAGCAGTTTCTATGATGTTCCGTAGTGTAAGATGCCCAGCAAACTATGAAAGCCGTGTCAGATAGGCCC"
        : int)];
  [%expect {| 791 |}]
;;
